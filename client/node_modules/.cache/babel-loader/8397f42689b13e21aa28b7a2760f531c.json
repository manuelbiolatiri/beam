{"ast":null,"code":"import _regeneratorRuntime from\"/Users/user/Desktop/manuel/flenjo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/user/Desktop/manuel/flenjo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/user/Desktop/manuel/flenjo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import{Button,Input}from\"../../../components\";import axiosRequest from\"../../../utils/apiservices\";import{apiRoutes}from\"../../../utils/apiRoutes\";import{encryptData}from\"../../../helpers\";import{useDispatch}from\"react-redux\";import{SIGNUP}from\"../../../redux/actions/types\";import{useHistory}from\"react-router-dom\";import{showToast}from\"../../../utils\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PhoneLogin=function PhoneLogin(_ref){var verifyPhone=_ref.verifyPhone,goBack=_ref.goBack,setPhoneNumber=_ref.setPhoneNumber,phoneNumber=_ref.phoneNumber,setPassword=_ref.setPassword,password=_ref.password,isSignup=_ref.isSignup;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isSubmitting=_useState2[0],setIsSubmitting=_useState2[1];var dispatch=useDispatch();var history=useHistory();var handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var _yield$axiosRequest,data,_data$data,token,user,_data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();setIsSubmitting(true);_context.prev=2;if(!isSignup){_context.next=9;break;}_context.next=6;return axiosRequest(\"post\",apiRoutes.verificationCode,{type:\"phone\",phone:\"0\"+phoneNumber.toString()});case 6:verifyPhone();_context.next=21;break;case 9:_context.next=11;return axiosRequest(\"post\",apiRoutes.login,{password:password,phone:phoneNumber.toString()});case 11:_yield$axiosRequest=_context.sent;data=_yield$axiosRequest.data;_data$data=data.data,token=_data$data.token,user=_data$data.user;// redirect to dashboard\nif(!(!user.firstName||!user.lastName||!user.gender)){_context.next=16;break;}return _context.abrupt(\"return\",history.push(\"/accountsettings\",{termsAndCondition:true}));case 16:localStorage.setItem(\"user\",encryptData(user));localStorage.setItem(\"access_token\",encryptData(token.access));showToast((data===null||data===void 0?void 0:data.message)||\"Your request was successful\",\"success\");dispatch({type:SIGNUP.SUCCESS,payload:user});history.push(\"/dashboard\");case 21:_context.next=31;break;case 23:_context.prev=23;_context.t0=_context[\"catch\"](2);//err handler here and notification if needed\n_data=_context.t0.response.data;if(!_data){_context.next=30;break;}return _context.abrupt(\"return\",showToast(_data.error,\"error\"));case 30:showToast(\"!Oops something went wrong. We are looking at it\",\"error\");case 31:_context.prev=31;setIsSubmitting(false);return _context.finish(31);case 34:case\"end\":return _context.stop();}}},_callee,null,[[2,23,31,34]]);}));return function handleSubmit(_x){return _ref2.apply(this,arguments);};}();var handleChange=function handleChange(e){var val=e.target.value;if(val.length===11)return;setPhoneNumber(val);};var handlePasswordChange=function handlePasswordChange(e){var val=e.target.value;setPassword(val);};return/*#__PURE__*/_jsxs(\"form\",{className:\"phone\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-title\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Enter Phone number\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"We will send a text with verification code. Message and data rate may apply.\",\" \"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"phone-div mt-3 flex justify-between\",children:[/*#__PURE__*/_jsx(\"button\",{disabled:true,children:\"+234\"}),/*#__PURE__*/_jsx(Input,{placeholder:\"80xxxxxxxx\",name:\"phoneNumber\",type:\"number\",className:\"number-input\",value:phoneNumber,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsx(\"div\",{className:\"phone-div mt-3 flex justify-between\",children:/*#__PURE__*/_jsx(Input,{placeholder:\"Enter your password\",name:\"password\",type:\"password\"// className=\"number-input\"\n,value:password,onChange:handlePasswordChange,required:true})}),/*#__PURE__*/_jsx(Button,{text:\"continue\",className:\"phone-cont\",type:\"submit\",disabled:phoneNumber.length<10||isSubmitting||password.length<6}),/*#__PURE__*/_jsx(\"p\",{className:\"back-btn\",onClick:function onClick(){return goBack();},children:\"Back\"})]});};export default PhoneLogin;","map":{"version":3,"sources":["/Users/user/Desktop/manuel/flenjo/client/src/views/landing/partials/LoginForm.jsx"],"names":["React","useState","Button","Input","axiosRequest","apiRoutes","encryptData","useDispatch","SIGNUP","useHistory","showToast","PhoneLogin","verifyPhone","goBack","setPhoneNumber","phoneNumber","setPassword","password","isSignup","isSubmitting","setIsSubmitting","dispatch","history","handleSubmit","e","preventDefault","verificationCode","type","phone","toString","login","data","token","user","firstName","lastName","gender","push","termsAndCondition","localStorage","setItem","access","message","SUCCESS","payload","response","error","handleChange","val","target","value","length","handlePasswordChange"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport { Button, Input } from \"../../../components\";\nimport axiosRequest from \"../../../utils/apiservices\";\nimport { apiRoutes } from \"../../../utils/apiRoutes\";\nimport { encryptData } from \"../../../helpers\";\nimport { useDispatch } from \"react-redux\";\nimport { SIGNUP } from \"../../../redux/actions/types\";\nimport { useHistory } from \"react-router-dom\";\nimport { showToast } from \"../../../utils\";\n\n\nconst PhoneLogin = ({ verifyPhone, goBack, setPhoneNumber, phoneNumber, setPassword, password, isSignup }) => {\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  const dispatch = useDispatch();\n  const history = useHistory();\n\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    setIsSubmitting(true);\n\n    try {\n      if(isSignup){\n        await axiosRequest(\"post\", apiRoutes.verificationCode, {\n          type: \"phone\",\n          phone: \"0\" + phoneNumber.toString(),\n        });\n\n        verifyPhone();\n      } else {\n        const { data } = await axiosRequest(\"post\", apiRoutes.login, {\n          password,\n          phone: phoneNumber.toString(),\n        });\n\n        const { token, user } = data.data;\n        // redirect to dashboard\n        if(!user.firstName || !user.lastName || !user.gender){\n          return history.push(\"/accountsettings\", {termsAndCondition: true});\n        }\n\n        localStorage.setItem(\"user\", encryptData(user))\n        localStorage.setItem(\"access_token\", encryptData(token.access))\n        showToast(data?.message || \"Your request was successful\", \"success\");\n\n        dispatch({type: SIGNUP.SUCCESS, payload: user});\n        history.push(\"/dashboard\");\n      }\n    } catch (err) {\n      //err handler here and notification if needed\n      let {data} = err.response;\n      if(data){\n          return showToast(data.error, \"error\")\n      } else{\n          showToast(\"!Oops something went wrong. We are looking at it\", \"error\")\n      }\n\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const handleChange = (e) => {\n    let val = e.target.value;\n    if (val.length === 11) return;\n    setPhoneNumber(val);\n  };\n\n  const handlePasswordChange = (e) => {\n    let val = e.target.value;\n    setPassword(val);\n  };\n\n  return (\n    <form className=\"phone\" onSubmit={handleSubmit}>\n      <div className=\"form-title\">\n        <h4>Enter Phone number</h4>\n        <p>\n          We will send a text with verification code. Message and data rate may\n          apply.{\" \"}\n        </p>\n      </div>\n\n      <div className=\"phone-div mt-3 flex justify-between\">\n        <button disabled>+234</button>\n\n        <Input\n          placeholder=\"80xxxxxxxx\"\n          name=\"phoneNumber\"\n          type=\"number\"\n          className=\"number-input\"\n          value={phoneNumber}\n          onChange={handleChange}\n          required\n        />\n\n      </div>\n      <div className=\"phone-div mt-3 flex justify-between\">\n\n      <Input\n          placeholder=\"Enter your password\"\n          name=\"password\"\n          type=\"password\"\n          // className=\"number-input\"\n          value={password}\n          onChange={handlePasswordChange}\n          required\n        />\n      </div>\n      <Button\n        text=\"continue\"\n        className=\"phone-cont\"\n        type=\"submit\"\n        disabled={phoneNumber.length < 10 || isSubmitting || password.length < 6}\n      />\n\n      <p className=\"back-btn\" onClick={() => goBack()}>\n        Back\n      </p>\n    </form>\n  );\n};\n\nexport default PhoneLogin;\n"]},"metadata":{},"sourceType":"module"}