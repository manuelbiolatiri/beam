{"ast":null,"code":"import _regeneratorRuntime from\"/Users/user/Desktop/manuel/flenjo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/user/Desktop/manuel/flenjo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/user/Desktop/manuel/flenjo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Button}from\"../../../components\";import OtpInput from\"react-otp-input\";import{useState}from\"react\";import{useHistory}from\"react-router-dom\";import{useDispatch}from\"react-redux\";import{SIGNUP}from\"../../../redux/actions/types\";import axiosRequest from\"../../../utils/apiservices\";import{apiRoutes}from\"../../../utils/apiRoutes\";import{encryptData}from\"../../../helpers\";import{showToast}from\"../../../utils\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var VerifyCode=function VerifyCode(_ref){var goBack=_ref.goBack,phoneNumber=_ref.phoneNumber,password=_ref.password;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),otp=_useState2[0],setOtp=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var history=useHistory();var dispatch=useDispatch();var phoneVerification=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$axiosRequest,data,_data$data,token,user,_err$response,_data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(!loading);_context.prev=1;_context.next=4;return axiosRequest(\"post\",apiRoutes.signup,{code:otp,phone:phoneNumber.toString(),password:password});case 4:_yield$axiosRequest=_context.sent;data=_yield$axiosRequest.data;_data$data=data.data,token=_data$data.token,user=_data$data.user;localStorage.setItem(\"user\",encryptData(user));localStorage.setItem(\"access_token\",encryptData(token.access));dispatch({type:SIGNUP.SUCCESS,payload:user});history.push(\"/accountsettings\",{termsAndCondition:true});_context.next=18;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](1);console.log(_context.t0);//err handler here and notification if needed\n_err$response=_context.t0===null||_context.t0===void 0?void 0:_context.t0.response,_data=_err$response.data;if(_data){showToast(_data===null||_data===void 0?void 0:_data.error,\"error\");}else{showToast(\"!Oops something went wrong. We are looking at it\",\"error\");}case 18:_context.prev=18;setLoading(false);return _context.finish(18);case 21:case\"end\":return _context.stop();}}},_callee,null,[[1,13,18,21]]);}));return function phoneVerification(){return _ref2.apply(this,arguments);};}();var resendVerificationCode=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axiosRequest(\"post\",apiRoutes.verificationCode,{type:\"phone\",phone:\"0\"+phoneNumber.toString()});case 3:_context2.next=7;break;case 5:_context2.prev=5;_context2.t0=_context2[\"catch\"](0);case 7:case\"end\":return _context2.stop();}}},_callee2,null,[[0,5]]);}));return function resendVerificationCode(){return _ref3.apply(this,arguments);};}();var handleSubmit=function handleSubmit(e){e.preventDefault();phoneVerification();};return/*#__PURE__*/_jsxs(\"form\",{className:\"phone\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-title\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Enter Verification Code\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"code-resend flex justify-between\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Provide the code sent to \",/*#__PURE__*/_jsx(\"span\",{children:\"0\".concat(phoneNumber)})]}),/*#__PURE__*/_jsx(\"p\",{style:{cursor:\"pointer\"},onClick:resendVerificationCode,children:\"Resend\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\" mt-3\",children:/*#__PURE__*/_jsx(OtpInput,{value:otp,onChange:function onChange(otp){return setOtp(otp);},shouldAutoFocus:true,numInputs:6,separator:/*#__PURE__*/_jsx(\"span\",{children:\"\\xA0 \\xA0 \"}),inputStyle:\"otp-input\",containerStyle:\"otp-cont\"})}),/*#__PURE__*/_jsx(Button,{text:\"continue\",className:\"phone-cont\",disabled:otp.length<6||loading}),/*#__PURE__*/_jsx(\"p\",{className:\"back-btn\",onClick:goBack,children:\"Back\"})]});};export default VerifyCode;","map":{"version":3,"sources":["/Users/user/Desktop/manuel/flenjo/client/src/views/landing/partials/VerifyCode.jsx"],"names":["Button","OtpInput","useState","useHistory","useDispatch","SIGNUP","axiosRequest","apiRoutes","encryptData","showToast","VerifyCode","goBack","phoneNumber","password","otp","setOtp","loading","setLoading","history","dispatch","phoneVerification","signup","code","phone","toString","data","token","user","localStorage","setItem","access","type","SUCCESS","payload","push","termsAndCondition","console","log","response","error","resendVerificationCode","verificationCode","handleSubmit","e","preventDefault","cursor","length"],"mappings":"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","sourcesContent":["import { Button } from \"../../../components\";\nimport OtpInput from \"react-otp-input\";\nimport { useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { useDispatch } from \"react-redux\";\nimport { SIGNUP } from \"../../../redux/actions/types\";\n\nimport axiosRequest from \"../../../utils/apiservices\";\nimport { apiRoutes } from \"../../../utils/apiRoutes\";\nimport { encryptData } from \"../../../helpers\";\nimport { showToast } from \"../../../utils\";\n\nexport const VerifyCode = ({ goBack, phoneNumber, password }) => {\n\n  const [otp, setOtp] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n\n  const history = useHistory();\n\n  const dispatch = useDispatch();\n\nconst phoneVerification = async () => {\n    setLoading(!loading);\n\n    try {\n        const { data } = await axiosRequest(\"post\", apiRoutes.signup, {\n          code: otp,\n          phone: phoneNumber.toString(),\n          password\n        });\n        const { token, user } = data.data;\n\n        localStorage.setItem(\"user\", encryptData(user))\n        localStorage.setItem(\"access_token\", encryptData(token.access))\n\n        dispatch({type: SIGNUP.SUCCESS, payload: user});\n        history.push(\"/accountsettings\", {termsAndCondition: true});\n\n      } catch (err) {\n          console.log(err)\n        //err handler here and notification if needed\n        let {data} = err?.response;\n        if(data){\n            showToast(data?.error, \"error\")\n        } else{\n            showToast(\"!Oops something went wrong. We are looking at it\", \"error\")\n        }\n      } finally {\n        setLoading(false);\n    }\n};\n\n\n\n  const resendVerificationCode = async () => {\n    try {\n      await axiosRequest(\"post\", apiRoutes.verificationCode, {\n        type: \"phone\",\n        phone: \"0\" + phoneNumber.toString(),\n      });\n    } catch (err) {\n      //err handler here and notification if needed\n    }\n  };\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    phoneVerification();\n  };\n\n  return (\n    <form className=\"phone\" onSubmit={handleSubmit}>\n      <div className=\"form-title\">\n        <h4>Enter Verification Code</h4>\n        <div className=\"code-resend flex justify-between\">\n          <p>\n            Provide the code sent to <span>{`0${phoneNumber}`}</span>\n          </p>\n          <p style={{ cursor: \"pointer\" }} onClick={resendVerificationCode}>\n            Resend\n          </p>\n        </div>\n      </div>\n\n      <div className=\" mt-3\">\n        <OtpInput\n          value={otp}\n          onChange={(otp) => setOtp(otp)}\n          shouldAutoFocus\n          numInputs={6}\n          separator={<span>&nbsp; &nbsp; </span>}\n          inputStyle=\"otp-input\"\n          containerStyle=\"otp-cont\"\n        />\n      </div>\n\n      <Button\n        text=\"continue\"\n        className=\"phone-cont\"\n        disabled={otp.length < 6 || loading}\n      />\n\n      <p className=\"back-btn\" onClick={goBack}>\n        Back\n      </p>\n    </form>\n  );\n};\n\nexport default VerifyCode;\n"]},"metadata":{},"sourceType":"module"}